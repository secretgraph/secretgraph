version: 3.9
services:
    nginx:
        image: docker.io/nginx:stable-alpine
        volumes:
            - ./nginx-docker.conf.template:/etc/nginx/templates/default.conf.template:ro
            - static_files:/static:ro
            - secretgraph:/vol
        ports:
            - '8000:8000'
        depends_on:
            - secretgraph
    secretgraph:
        build:
            context: .
        volumes:
            - secretgraph:/var/secretgraph
            - static_files:/app/static
        environment:
            USER_GROUP: '101'
            SECRET_KEY: 'changeme'
            ALLOWED_HOSTS: 'localhost'

volumes:
    static_files:
    secretgraph:
